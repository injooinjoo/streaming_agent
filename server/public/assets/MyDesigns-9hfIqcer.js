import{c as P,r as c,o as R,a as A,j as e,y as b,_ as k,N as B,R as I,L as T,bt as q,E as F,bC as O,a1 as Q,bx as w,bD as U,bE as H,k as K,bn as X,bu as G,bv as J,bw as V,q as W,by as Y,p as Z,B as ee,M as se}from"./index-CrNmBE9G.js";import{C as ae,P as f}from"./package-qA1LpfLE.js";const te=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],S=P("square-pen",te),p="",N={draft:{label:"임시저장",color:"gray",icon:e.jsx(S,{size:14})},pending:{label:"심사중",color:"yellow",icon:e.jsx(K,{size:14})},approved:{label:"승인됨",color:"green",icon:e.jsx(H,{size:14})},rejected:{label:"거절됨",color:"red",icon:e.jsx(U,{size:14})},archived:{label:"보관됨",color:"gray",icon:e.jsx(w,{size:14})}},ie={chat:{label:"채팅",icon:e.jsx(se,{size:16})},alert:{label:"알림",icon:e.jsx(ee,{size:16})},goal:{label:"목표",icon:e.jsx(Z,{size:16})},ticker:{label:"전광판",icon:e.jsx(Y,{size:16})},subtitle:{label:"자막",icon:e.jsx(W,{size:16})},roulette:{label:"룰렛",icon:e.jsx(w,{size:16})},emoji:{label:"이모지",icon:e.jsx(V,{size:16})},voting:{label:"투표",icon:e.jsx(J,{size:16})},credits:{label:"크레딧",icon:e.jsx(G,{size:16})},ad:{label:"광고",icon:e.jsx(X,{size:16})},package:{label:"패키지",icon:e.jsx(f,{size:16})}},re=()=>{const[v,g]=c.useState([]),[d,y]=c.useState(!0),[n,C]=c.useState("all"),[h,$]=c.useState(""),[l,r]=c.useState(null),{user:ce,token:o}=R(),j=A(),m=async()=>{if(o){y(!0);try{const s=new URLSearchParams;n!=="all"&&s.append("status",n);const a=await fetch(`${p}/api/designs?${s}`,{headers:{Authorization:`Bearer ${o}`}});if(a.ok){const t=await a.json();g(t.designs||[])}}catch(s){console.error("Failed to fetch designs:",s)}finally{y(!1)}}};c.useEffect(()=>{m()},[o,n]);const L=async s=>{if(confirm("정말 이 디자인을 삭제하시겠습니까?"))try{const a=await fetch(`${p}/api/designs/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}});if(a.ok)g(v.filter(t=>t.id!==s));else{const t=await a.json();alert(t.error||"삭제에 실패했습니다.")}}catch{alert("삭제 중 오류가 발생했습니다.")}},_=async s=>{if(confirm("이 디자인을 마켓플레이스 심사에 제출하시겠습니까?"))try{const a=await fetch(`${p}/api/designs/${s}/submit`,{method:"POST",headers:{Authorization:`Bearer ${o}`}});if(a.ok)m(),alert("심사에 제출되었습니다.");else{const t=await a.json();alert(t.error||"제출에 실패했습니다.")}}catch{alert("제출 중 오류가 발생했습니다.")}},z=v.filter(s=>s.name.toLowerCase().includes(h.toLowerCase())||(s.description||"").toLowerCase().includes(h.toLowerCase())),D=s=>ie[s]||{label:s,icon:e.jsx(f,{size:16})},E=s=>N[s]||N.draft,u=s=>{if(!s)return"";const a=new Date(s),x=new Date-a,i=Math.floor(x/(1e3*60*60*24));return i===0?"오늘":i===1?"어제":i<7?`${i}일 전`:a.toLocaleDateString("ko-KR")};return e.jsxs("div",{className:"my-designs-container",children:[e.jsxs("header",{className:"my-designs-header",children:[e.jsx("div",{className:"header-left",children:e.jsxs(b,{to:"/",className:"back-button",children:[e.jsx(ae,{size:20}),"대시보드"]})}),e.jsxs("div",{className:"header-center",children:[e.jsx("h1",{className:"page-title",children:"내 디자인"}),e.jsx("p",{className:"page-subtitle",children:"만든 오버레이 디자인을 관리하세요"})]}),e.jsx("div",{className:"header-right",children:e.jsxs(b,{to:"/designer",className:"create-button",children:[e.jsx(k,{size:18}),"새 디자인 만들기"]})})]}),e.jsxs("div",{className:"my-designs-filters",children:[e.jsxs("div",{className:"search-bar",children:[e.jsx(B,{size:18}),e.jsx("input",{type:"text",placeholder:"디자인 검색...",value:h,onChange:s=>$(s.target.value)})]}),e.jsxs("div",{className:"filter-tabs",children:[e.jsx("button",{className:`filter-tab ${n==="all"?"active":""}`,onClick:()=>C("all"),children:"전체"}),Object.entries(N).map(([s,a])=>e.jsxs("button",{className:`filter-tab ${n===s?"active":""} status-${a.color}`,onClick:()=>C(s),children:[a.icon,a.label]},s))]}),e.jsx("button",{onClick:m,className:"refresh-button",disabled:d,children:e.jsx(I,{size:18,className:d?"spin":""})})]}),e.jsx("div",{className:"designs-list",children:d?e.jsx(T,{}):z.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(f,{size:48}),e.jsx("h3",{children:"디자인이 없습니다"}),e.jsx("p",{children:"새 디자인을 만들어보세요!"}),e.jsxs(b,{to:"/designer",className:"empty-create-button",children:[e.jsx(k,{size:18}),"새 디자인 만들기"]})]}):e.jsx("div",{className:"designs-grid",children:z.map(s=>{const a=D(s.category),t=E(s.status),x=s.status==="draft"||s.status==="rejected",i=s.status!=="pending",M=s.status==="draft"||s.status==="rejected";return e.jsxs("div",{className:"design-card",children:[e.jsxs("div",{className:"design-thumbnail",children:[s.thumbnail_url?e.jsx("img",{src:s.thumbnail_url,alt:s.name}):e.jsx("div",{className:"thumbnail-placeholder",children:a.icon}),e.jsxs("div",{className:`status-badge ${t.color}`,children:[t.icon,t.label]}),e.jsx("div",{className:"category-badge",children:a.label})]}),e.jsxs("div",{className:"design-content",children:[e.jsx("h3",{className:"design-name",children:s.name}),s.description&&e.jsx("p",{className:"design-description",children:s.description}),e.jsxs("div",{className:"design-meta",children:[e.jsx("span",{className:"meta-item",children:u(s.updated_at||s.created_at)}),s.submitted_at&&s.status==="pending"&&e.jsxs("span",{className:"meta-item pending-info",children:[u(s.submitted_at)," 제출"]})]}),s.status==="rejected"&&s.rejection_reason&&e.jsxs("div",{className:"rejection-reason",children:[e.jsx(q,{size:14}),e.jsxs("span",{children:["거절 사유: ",s.rejection_reason]}),e.jsx("button",{className:"view-reason-button",onClick:()=>r(s),children:"자세히"})]}),e.jsxs("div",{className:"design-actions",children:[x&&e.jsxs("button",{className:"action-button edit",onClick:()=>j(`/designer/${s.id}`),title:"편집",children:[e.jsx(S,{size:16}),"편집"]}),e.jsxs("button",{className:"action-button preview",onClick:()=>j(`/designer/${s.id}?preview=true`),title:"미리보기",children:[e.jsx(F,{size:16}),"미리보기"]}),M&&e.jsxs("button",{className:"action-button submit",onClick:()=>_(s.id),title:"심사 제출",children:[e.jsx(O,{size:16}),s.status==="rejected"?"재제출":"공유하기"]}),i&&e.jsx("button",{className:"action-button delete",onClick:()=>L(s.id),title:"삭제",children:e.jsx(Q,{size:16})})]})]})]},s.id)})})}),l&&e.jsx("div",{className:"modal-overlay",onClick:()=>r(null),children:e.jsxs("div",{className:"modal-content",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"거절 사유"}),e.jsx("button",{className:"modal-close",onClick:()=>r(null),children:"×"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"reject-design-info",children:[e.jsx("strong",{children:l.name}),e.jsxs("span",{className:"reject-date",children:[u(l.reviewed_at)," 거절됨"]})]}),e.jsx("div",{className:"reject-reason-text",children:l.rejection_reason}),e.jsx("p",{className:"reject-help",children:"거절 사유를 확인하고 디자인을 수정한 후 다시 제출할 수 있습니다."})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"modal-button secondary",onClick:()=>r(null),children:"닫기"}),e.jsx("button",{className:"modal-button primary",onClick:()=>{j(`/designer/${l.id}`),r(null)},children:"수정하기"})]})]})})]})};export{re as default};
